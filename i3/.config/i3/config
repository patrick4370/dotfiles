# vim: filetype=i3
# i3wm configuration
# Updated: 06/August/2024 11:36  
# Modified by Patrick Heffernan <patrick4370@bigpond.com>

# Font for window titles. Will also be used by the bar unless a different font 
# is used in the bar {} block below.
font pango:Inconsolata:Mono:Bold 9, FontAwesome 10
# for_window [all] title_window_icon on

# Variables
set $mod mod4
set $gaps 3
set $term --no-startup-id $TERMINAL 
set $launcher-clipboard-insert clipcat-menu insert
set $launcher-clipboard-remove clipcat-menu remove

# Colours
set $rosewater #f4dbd6
set $flamingo #f0c6c6
set $pink #f5bde6
set $mauve #c6a0f6
set $red #ed8796
set $maroon #ee99a0
set $peach #fab387
set $yellow #eed49f
set $green #a6da95
set $teal #8bd5ca
set $sky #91d7e3
set $sapphire #7dc4e4
set $blue #8aadf4
set $lavender #b7bdf8
set $text #cad3f5
set $subtext1 #b8c0e0
set $subtext0 #a5adcb
set $overlay2 #939ab7
set $overlay1 #8087a2
set $overlay0 #6e738d
set $surface2 #5b6078
set $surface1 #494d64
set $surface0 #363a4f
set $base #24273a
set $mantle #1e2030
set $crust #181926
set $barback #424242

# Autostart
exec --no-startup-id /home/patrick/.screenlayout/screenlayout.sh
exec --no-startup-id /usr/bin/ibus-daemon -drxR
exec --no-startup-id dex --autostart --environment i3
exec_always --no-startup-id /usr/bin/picom --config ~/.config/picom/picom.conf
exec --no-startup-id /usr/bin/setxkbmap -option "caps:escape_shifted_capslock"
exec --no-startup-id xinput --set-prop "AlpsPS/2 ALPS DualPoint TouchPad" "Device Enabled" 0
exec --no-startup-id xinput --set-prop "AT Translated Set 2 keyboard" "Device Enabled" 0
exec --no-startup-id xinput --set-prop "AlpsPS/2 ALPS DualPoint Stick" "Device Enabled" 0
exec --no-startup-id /usr/bin/autotiling
exec --no-startup-id /usr/bin/rclone mount --vfs-cache-mode full --vfs-cache-max-age 1h --vfs-cache-max-size 50G --daemon gdrive: /home/patrick/gdrive 
exec --no-startup-id /usr/bin/rclone mount --vfs-cache-mode full --vfs-cache-max-age 1h --vfs-cache-max-size 50G --daemon onedrive: /home/patrick/onedrive
exec_always --no-startup-id /usr/bin/rclone mount --daemon pidns: /home/patrick/pidns/
exec --no-startup-id xidlehook --not-when-audio --not-when-fullscreen --timer 600 "~/.local/bin/i3lockscript.sh" "" &
exec --no-startup-id /usr/bin/numlockx 
exec --no-startup-id /usr/bin/tailscale-systray
exec_always --no-startup-id /usr/bin/clipcatd
exec --no-startup-id /usr/bin/udiskie -sna
exec --no-startup-id /usr/bin/lxpolkit
exec --no-startup-id xrandr --output eDP-1 --screenlayoutale 1.2x1.2
exec --no-startup-id xrdb -load -I${HOME}/.Xresources.d ~/.Xresources

# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

# Gaps for the windows
gaps inner $gaps
gaps outer $gaps
#
# Only show gaps when multiple windows open
smart_gaps on

# Focus Follows Mouse
focus_follows_mouse no

# Orientation for new workspaces
default_orientation horizontal

# Popups during fullscreen mode
popup_during_fullscreen smart

# Automatic Back and Forth
workspace_auto_back_and_forth yes

# Workspace layout
workspace_layout default
# default_orientation horizontal

# If a window is activated, e.g., via google-chrome www.google.com, it may request to take focus. 
# Since this might not be preferable, different reactions can be configured.
focus_on_window_activation smart

# Show Marks on Windows
show_marks yes

tiling_drag modifier

# Colours for windows
# class                  border    bground  text    indicator  child_border
client.focused           $blue     $base    $yellow $blue      $blue
client.focused_inactive  $overlay0 $base    $text   $rosewater $overlay0
client.unfocused         $overlay0 $base    $text   $rosewater $overlay0
client.urgent            $peach    $base    $yellow $overlay0  $peach
client.placeholder       $overlay0 $base    $yellow $overlay0  $overlay0
client.background        $base

# Define names for default workspaces for which we configure key bindings later on.
# We use variables to avoid repeating the names in multiple places.
set $ws1 "1: Shell "
set $ws2 "2: Mail "
set $ws3 "3: Web "
set $ws4 "4: Chat "
set $ws5 "5: Editor "
set $ws6 "6: Config "
set $ws7 "7: Video "
set $ws8 "8: Audio "
set $ws9 "9: Playground "
set $ws10 "10: PDF"
 
# Applications to open on their respective workspace
assign [class="betterbird"]                             $ws2
assign [class="librewolf"]                              $ws3  
assign [class="Caprine" window_role="browser-window"]   $ws4
assign [class="Abiword"]                                $ws5  
assign [class="tm"]                                     $ws5
assign [class="Arronax"]                                $ws6
assign [class="Fr.handbrake.ghb"]                       $ws7
assign [class="odysee-nativefier-58e76e"]               $ws7
assign [class="strawberry"]                             $ws7
assign [class="Picard"]                                 $ws8
assign [class="GLava"]                                  $ws9  
assign [class="Zathura"]                                $ws10

# Floating windows & Layouts
for_window [class="Arandr" instance="arandr"] floating enable, resize set 800 800, move position center
for_window [class="Authenticator" instance="authenticator"] floating enabled, resize set 1000 700
for_window [class="Bitwarden"] move position center, resize set 1170 900, floating enable 
for_window [class="GParted"] floating enable, resize set 1120 700, move position center
for_window [class="Gnome-disks"] floating enable
for_window [class="Imager" instance="rpi-imager"] floating enable
for_window [class="Lightdm-gtk-greeter-settings"] floating enable, move position center
for_window [class="Lxappearance"] floating enable, resize set 800 600, move position center
for_window [class="Nl.hjdskes.gcolor3"] floating enable, resize set 780 305
for_window [class="Nsxiv"] floating enable
for_window [class="Sound-juicer"] floating enable, resize set 1000 800, move position center
for_window [class="Usbimager" instance="usbimager"] floating enable
for_window [class="Xarchiver"] floating enable, resize set 1024 768, move position center
for_window [class="Yad"] floating enable, move position center
for_window [class="Yubico-authenticator" instance="yubico-authenticator"] floating enabled, resize set 1000 700
for_window [class="Zathura"] focus
for_window [class="^.*"] border pixel 1
for_window [class="betterbird" window_role="about"] floating enable, move position center
for_window [class="betterbird"] layout tabbed
for_window [class="feh"] floating enable, move position center
for_window [class="librewolf" window_role="About"] floating enable, move position center
for_window [class="mpv" instance="gl"] floating enable, move position center
for_window [class="pavucontrol" title="Volume Control"] floating enable
for_window [class="vlc" window_role="vlc-main"] floating enabled, resize set 950 940
for_window [class="yazi"] floating enable, resize set 1700 1000, move position center
for_window [class="zenity"] floating enable, resize set 600 800, move position center
for_window [id=56623110 title="MakeMKV BETA"] floating enable
for_window [instance="ncmpcpp"] floating enable, resize set 1200 700, move position center
for_window [instance="paru"] sticky enable, floating enable, resize set 1600 800, border pixel 1, move position center
for_window [class="QtPass" instance="qtpass"] floating enable, resize set 1000 600, move position center

# Move through workspaces
bindsym Mod1+$mod+Right workspace next
bindsym Mod1+$mod+Left workspace prev

# Kill window with $mod + mouse button two
bindsym --whole-window $mod+button2 kill

bindsym $mod+Ctrl+f focus parent; fullscreen; focus child

# Yubico Authenticator
bindsym $mod+b exec --no-startup-id /usr/bin/yubico-authenticator


bindsym $mod+c exec /usr/bin/clipcat-menu

# Volume control
bindsym XF86AudioRaiseVolume exec --no-startup-id ponymix increase 5; exec pkill -SIGRTMIN+10 i3blocks      # increase sound volume
bindsym XF86AudioLowerVolume exec --no-startup-id ponymix decrease 5; exec pkill -SIGRTMIN+10 i3blocks      # decrease sound volume
bindsym XF86AudioMute exec --no-startup-id ponymix toggle; exec --no-startup-id pkill -SIGRTMIN+10 i3blocks	# mute sound

# Jump to urgent window
bindsym $mod+x [urgent=latest] focus

# i3lock script
bindsym $mod+Shift+x exec --no-startup-id ~/.local/bin/i3lockscript.sh

# Focus parent window
bindsym $mod+a focus parent

# Clipboard
bindsym $mod+p exec $launcher-clipboard-insert
bindsym $mod+o exec $launcher-clipboard-remove

# Start Rofi as program launcher
bindsym $mod+d exec --no-startup-id rofi -show drun -show-icons -sorting-method fzf eDP1

# Reload i3wm config file
bindsym $mod+Shift+c reload

# Restart i3wm in place
bindsym $mod+Shift+r restart

# Load a random wallpaper
bindsym $mod+Shift+w exec --no-startup-id feh --randomize --bg-fill ~/Pictures/wallpapers/*

# Emoji
bindsym $mod+period exec --no-startup-id ~/.local/bin/rofiunicode

# start a terminal
bindsym $mod+Return exec --no-startup-id $term

# kill focused window
bindsym $mod+q kill

# Help system using rofi and yad
bindsym $mod+F1 exec --no-startup-id ~/.local/bin/yad-help.sh

# change focus
bindsym $mod+h focus left
bindsym $mod+j focus down
bindsym $mod+k focus up
bindsym $mod+l focus right

# alternatively, you can use the cursor keys:
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

# move focused window
bindsym $mod+Shift+h move left
bindsym $mod+Shift+j move down
bindsym $mod+Shift+k move up
bindsym $mod+Shift+l move right

# alternatively, you can use the cursor keys:
bindsym $mod+Shift+Left move left
bindsym $mod+Shift+Down move down
bindsym $mod+Shift+Up move up
bindsym $mod+Shift+Right move right

# split in horizontal orientation
bindsym Mod1+h split h

# SSH
bindsym $mod+r exec --no-startup-id rofi -show ssh

# split in vertical orientation
bindsym $mod+v split v

# Toggle split
bindsym $mod+t split toggle

# enter fullscreen mode for the focused container
bindsym $mod+f fullscreen toggle

# Start ncmpcpp
bindsym $mod+m exec --no-startup-id alacritty --class ncmpcpp -e /usr/bin/ncmpcpp -S visualizer

# change container layout (stacked, tabbed, toggle split)
# bindsym $mod+s layout stacking
bindsym $mod+w layout tabbed
bindsym $mod+s layout stacked
bindsym $mod+e layout toggle split

# toggle tiling / floating
bindsym $mod+shift+space floating toggle

# change focus between tiling / floating windows
bindsym $mod+space focus mode_toggle

# Screen Shots Select Area
bindsym --release $mod+Shift+F12 exec --no-startup-id escrotum --select '~/Pictures/Screenshots/%Y-%m-%d-%H%M%S_$wx$h_escrotum.png' && notify-send "Selection saved"
# Screenreen Shotsots Desktop
bindsym --release $mod+F12 exec --no-startup-id escrotum '~/Pictures/Screenshots/%Y-%m-%d-%H%M%S_$wx$h_escrotum.png' && notify-send "Screenshot saved"
# Screen Shots Desktoplay 8 seconds
bindsym --release $mod+Shift+d exec --no-startup-id escrotum --delay 8 '~/Pictures/Screenshots/%Y-%m-%d-%H%M%S_$wx$h_escrotum.png' && notify-send "Screenshot saved"
# Screenshotreen Shotsotsots Take Shot of window_rolendow
bindsym --release $mod+F11 exec --no-startup-id escrotum -x $(xwininfo -int | awk '/Window id:/ {print $4}') '~/Pictures/Screenshots/%Y-%m-%d-%H%M%S_$wx$h_escrotum.png' && notify-send "Window screenshot saved"

# exit i3 (logs you out of your X session)
bindsym Ctrl+Mod1+Delete exec --no-startup-id ~/.local/bin/rofi-power "i3-msg exit"

# Resizing windows by 10
bindsym $mod+Ctrl+Right resize shrink width 10 px or 10 ppt
bindsym $mod+Ctrl+Up resize grow height 10 px or 10 ppt
bindsym $mod+Ctrl+Down resize shrink height 10 px or 10 ppt
bindsym $mod+Ctrl+Left resize grow width 10 px or 10 ppt

# Instant scratchpad on any window
bindsym $mod+Page_Up mark "alpha", move scratchpad
bindsym $mod+Page_Down [con_mark="alpha"] scratchpad show,floating disable

# Mark a Window
bindsym $mod+Shift+m exec i3-input -F 'mark %s' -l 1 -P 'Mark: '
# Goto Marked Window
bindsym $mod+g exec i3-input -F '[con_mark="%s"] focus' -l 1 -P 'Goto: '

# switch to workspace
bindsym $mod+1 workspace $ws1
bindsym $mod+2 workspace $ws2
bindsym $mod+3 workspace $ws3
bindsym $mod+4 workspace $ws4
bindsym $mod+5 workspace $ws5
bindsym $mod+6 workspace $ws6
bindsym $mod+7 workspace $ws7
bindsym $mod+8 workspace $ws8
bindsym $mod+9 workspace $ws9
bindsym $mod+0 workspace $ws10

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace number $ws1; workspace $ws1 
bindsym $mod+Shift+2 move container to workspace number $ws2; workspace $ws2 
bindsym $mod+Shift+3 move container to workspace number $ws3; workspace $ws3 
bindsym $mod+Shift+4 move container to workspace number $ws4; workspace $ws4 
bindsym $mod+Shift+5 move container to workspace number $ws5; workspace $ws5 
bindsym $mod+Shift+6 move container to workspace number $ws6; workspace $ws6 
bindsym $mod+Shift+7 move container to workspace number $ws7; workspace $ws7 
bindsym $mod+Shift+8 move container to workspace number $ws8; workspace $ws8 
bindsym $mod+Shift+9 move container to workspace number $ws9; workspace $ws9 
bindsym $mod+Shift+0 move container to workspace number $ws10; workspace $ws10

# Create QR code from saved URL on Clipboard
bindsym $mod+Shift+q exec xclip -selection clipboard -o | qrencode -o ~/.qr.png; exec nsxiv ~/.qr.png

# Toggle Status Bar on/off
bindsym $mod+Shift+b bar mode toggle

# Start i3status-rust with configuration & colours
bar 
{
    font pango:Inconsolata Nerd Font, Material Icons 14
	status_command /usr/bin/i3status-rs 
	position top
	output eDP-1
    workspace_min_width 60
    strip_workspace_numbers yes
    binding_mode_indicator yes

    colors {
        #Class             border       Background      Text
        background         $barback
        statusline         $red         $barback        #ffffff
        focused_statusline $text
        focused_separator  $base
        focused_workspace  $blue        $base           $yellow
        active_workspace   $overlay0    $text           $green
        inactive_workspace $overlay0    $base           $surface2
        urgent_workspace   $red         $base           $red
        binding_mode       $base        $base           $surface1
      }
}

# Scratchpad - Plain old terminal
exec --no-startup-id alacritty --class dropdown
bindsym $mod+u [instance="dropdown"] scratchpad show; [instance="dropdown"] move position center
for_window [instance="dropdown"] floating enable, sticky enable, resize set 1500 700, move scratchpad

# bpytop
exec --no-startup-id alacritty --class btop -e btop
bindsym $mod+Shift+t [instance="btop"] scratchpad show; [instance="btop"] move position center
for_window [instance="btop"] floating enable, sticky enable, resize set 1500 700, move scratchpad

# Newsboat
exec --no-startup-id alacritty --class newsboat -e newsboat
bindsym $mod+n [instance="newsboat"] scratchpad show; [instance="newsboat"] move position center
for_window [instance="newsboat"] floating enable, resize set 1500 700, move scratchpad
